/**
  ******************************************************************************
  * @file    main.c
  * @author  Ac6
  * @version V1.0
  * @date    01-December-2013
  * @brief   Default main function.
  ******************************************************************************
*/

#include "stm32f0xx.h"
#include "stm32f0xx_hal.h"

#include "stm32f0xx_hal_gpio.h"
#include "stm32f0xx_hal_rcc.h"
#include "stm32f0xx_hal_flash.h"

#include "hal.h"

static void SystemClock_Config(void){

    HAL_RCC_DeInit();
    HAL_RCC_EnableCSS();

    RCC_ClkInitTypeDef RCC_ClkInitStruct;

    RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
    RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;
    RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK|RCC_CLOCKTYPE_PCLK1;
    RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;

    RCC_PLLInitTypeDef RCC_PLLInitStruct;

    RCC_PLLInitStruct.PLLMUL = HAL_RCC_PLL_MUL;
    RCC_PLLInitStruct.PLLSource = HAL_RCC_PLL_SOURCE;
    RCC_PLLInitStruct.PLLState = HAL_RCC_PLL_STATE;
    RCC_PLLInitStruct.PREDIV = HAL_RCC_PLL_PREIV;

    RCC_OscInitTypeDef RCC_OscInitStruct;

    RCC_OscInitStruct.HSEState = HAL_RCC_HSE_STATE;
    RCC_OscInitStruct.HSI14CalibrationValue = RCC_HSI14CALIBRATION_DEFAULT;
    RCC_OscInitStruct.HSI14State = RCC_HSI14_OFF;
    RCC_OscInitStruct.HSICalibrationValue = RCC_HSICALIBRATION_DEFAULT;
    RCC_OscInitStruct.HSIState = HAL_RCC_HSI_STATE;
    RCC_OscInitStruct.LSEState = RCC_LSE_OFF;
    RCC_OscInitStruct.LSIState = RCC_LSI_OFF;
    RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;
    RCC_OscInitStruct.PLL = RCC_PLLInitStruct;

    HAL_RCC_OscConfig(&RCC_OscInitStruct);
    HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_1);
}


int main(void){

    HAL_Init();
    SystemClock_Config();

	__HAL_RCC_GPIOC_CLK_ENABLE();

	GPIO_InitTypeDef GPIO_InitStruct;

	GPIO_InitStruct.Pin = GPIO_PIN_9;
	GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
	GPIO_InitStruct.Pull = GPIO_NOPULL;
	GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;

	HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

	HAL_GPIO_WritePin(GPIOC, GPIO_PIN_9, GPIO_PIN_SET);



	for(;;)
	{
	    HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_9);
	    HAL_Delay(500);
	}
}
